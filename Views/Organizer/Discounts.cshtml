@model online_event_booking_system.Models.DiscountViewModel
@{
    ViewData["Title"] = "Discounts";
    Layout = "_DashboardLayout";
}

<!-- Organizer Discounts Container -->
<div class="min-h-screen bg-dark-navy text-white pt-16">
    <!-- Main Content -->
    <div class="p-4 md:p-6 pt-8">
            <!-- Success Message -->
            @if (TempData["SuccessMessage"] != null)
            {
                <div class="mb-6 p-4 bg-green-500/20 border border-green-500/30 rounded-xl text-green-400 flex items-center space-x-3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>@TempData["SuccessMessage"]</span>
                </div>
            }

            <!-- Page Header -->
            <div class="mb-8">
                <div class="flex flex-col md:flex-row items-start md:items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-400 to-teal-400 text-transparent bg-clip-text mb-2">Discounts</h1>
                        <p class="text-gray-400">Create and manage discount codes for your events</p>
                    </div>
                    <div class="mt-4 md:mt-0 flex space-x-3">
                        <button class="bg-white/10 border border-white/20 text-white px-4 py-2 rounded-xl hover:bg-white/20 transition-all duration-200 flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>Export</span>
                        </button>
                        <button id="toggleCreateForm" class="bg-gradient-to-r from-purple-500 to-teal-500 text-white px-4 py-2 rounded-xl font-bold hover:from-purple-600 hover:to-teal-600 transition-all transform hover:scale-105 shadow-lg flex items-center space-x-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            <span id="toggleText">Create Discount</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Discount Stats -->
            <section aria-label="Discount Statistics" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-8">
                <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-green-500/20 rounded-xl">
                            <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <span class="text-green-400 text-sm font-semibold">Active</span>
                    </div>
                    <p class="text-gray-400 text-sm">Active Discounts</p>
                    <p class="text-3xl font-bold mt-2">8</p>
                    <p class="text-gray-400 text-xs mt-1">Currently running</p>
                </div>
                
                <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-blue-500/20 rounded-xl">
                            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                            </svg>
                        </div>
                        <span class="text-blue-400 text-sm font-semibold">$2,450</span>
                    </div>
                    <p class="text-gray-400 text-sm">Total Savings</p>
                    <p class="text-3xl font-bold mt-2">$2,450</p>
                    <p class="text-gray-400 text-xs mt-1">This month</p>
                </div>
                
                <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-purple-500/20 rounded-xl">
                            <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path>
                            </svg>
                        </div>
                        <span class="text-purple-400 text-sm font-semibold">1,234</span>
                    </div>
                    <p class="text-gray-400 text-sm">Codes Used</p>
                    <p class="text-3xl font-bold mt-2">1,234</p>
                    <p class="text-gray-400 text-xs mt-1">Total redemptions</p>
                </div>
                
                <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-teal-500/20 rounded-xl">
                            <svg class="w-6 h-6 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                        </div>
                        <span class="text-teal-400 text-sm font-semibold">+15.2%</span>
                    </div>
                    <p class="text-gray-400 text-sm">Conversion Rate</p>
                    <p class="text-3xl font-bold mt-2">12.5%</p>
                    <p class="text-gray-400 text-xs mt-1">vs last month</p>
                </div>
            </section>

            
            <!-- Filters and Search -->
            <section aria-label="Filters" class="mb-8">
                <div class="flex flex-col lg:flex-row items-center justify-between space-y-4 lg:space-y-0 lg:space-x-4">
                    <div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-4 w-full lg:w-auto">
                        <div class="relative w-full sm:w-80">
                            <input type="text" 
                                   placeholder="Search discount codes..." 
                                   class="w-full px-4 py-3 pl-12 bg-white/10 border border-white/20 rounded-2xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500 backdrop-blur-sm">
                            <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                        <select aria-label="Status filter" class="px-4 py-3 bg-white/10 border border-white/20 rounded-2xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500 backdrop-blur-sm w-full sm:w-48">
                            <option>All Status</option>
                            <option>Active</option>
                            <option>Expired</option>
                            <option>Paused</option>
                        </select>
                        <select aria-label="Event filter" class="px-4 py-3 bg-white/10 border border-white/20 rounded-2xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500 backdrop-blur-sm w-full sm:w-48">
                            <option>All Events</option>
                            <option>Summer Music Festival</option>
                            <option>Tech Conference 2024</option>
                            <option>Art Exhibition</option>
                        </select>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button class="p-3 bg-white/10 border border-white/20 rounded-xl hover:bg-white/20 transition-all duration-200" title="Grid View">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                            </svg>
                        </button>
                        <button class="p-3 bg-gradient-to-r from-purple-500 to-teal-500 rounded-xl" title="List View">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Discounts Table -->
            <section aria-label="Discounts" class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl overflow-hidden mb-8">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-white/10">
                            <tr>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Discount Code</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Type</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Value</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Event</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Usage</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Expires</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Status</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-white">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-white/10">
                            @for (var i = 0; i < 15; i++)
                            {
                                var codes = new[] { "EARLY20", "VIP15", "FLASH30", "STUDENT10", "GROUP25", "SUMMER50", "WELCOME5", "LOYALTY20", "NEWUSER10", "BULK20", "EARLYBIRD25", "FINAL10", "WEEKEND15", "MEMBER30", "SPECIAL40" };
                                var types = new[] { "Percentage", "Fixed Amount", "Percentage", "Percentage", "Percentage", "Fixed Amount", "Percentage", "Percentage", "Percentage", "Percentage", "Percentage", "Percentage", "Percentage", "Percentage", "Percentage" };
                                var values = new[] { "20%", "$15", "30%", "10%", "25%", "$50", "5%", "20%", "10%", "20%", "25%", "10%", "15%", "30%", "40%" };
                                var events = new[] { "Summer Music Festival", "Tech Conference 2024", "Art Exhibition", "All Events", "Food & Wine Tasting", "Comedy Night", "All Events", "All Events", "All Events", "All Events", "All Events", "All Events", "All Events", "All Events", "All Events" };
                                var usages = new[] { "45/100", "12/50", "8/25", "156/500", "23/100", "3/10", "89/200", "67/150", "34/100", "78/200", "12/50", "45/100", "23/75", "56/150", "9/25" };
                                var expires = new[] { "Dec 31, 2024", "Jan 15, 2025", "Dec 20, 2024", "Mar 1, 2025", "Feb 14, 2025", "Dec 25, 2024", "Jun 30, 2025", "Apr 1, 2025", "Jan 31, 2025", "Feb 28, 2025", "Mar 15, 2025", "Apr 30, 2025", "May 15, 2025", "Jun 30, 2025", "Jul 15, 2025" };
                                var statuses = new[] { "Active", "Active", "Active", "Active", "Active", "Expired", "Active", "Paused", "Active", "Active", "Active", "Active", "Active", "Active", "Active" };
                                var statusColors = new[] { "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-red-500/20 text-red-400", "bg-green-500/20 text-green-400", "bg-yellow-500/20 text-yellow-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400", "bg-green-500/20 text-green-400" };
                                
                                <tr class="hover:bg-white/5 transition-all duration-200">
                                    <td class="px-6 py-4">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-teal-500 rounded-lg flex items-center justify-center">
                                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                                </svg>
                                            </div>
                                            <div>
                                                <p class="text-white font-semibold">@codes[i % codes.Length]</p>
                                                <p class="text-gray-400 text-sm">@types[i % types.Length]</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 text-gray-300">@types[i % types.Length]</td>
                                    <td class="px-6 py-4 text-white font-semibold">@values[i % values.Length]</td>
                                    <td class="px-6 py-4 text-gray-300">@events[i % events.Length]</td>
                                    <td class="px-6 py-4 text-gray-300">@usages[i % usages.Length]</td>
                                    <td class="px-6 py-4 text-gray-300">@expires[i % expires.Length]</td>
                                    <td class="px-6 py-4">
                                        <span class="px-3 py-1 rounded-full text-xs font-medium @statusColors[i % statusColors.Length]">@statuses[i % statuses.Length]</span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex space-x-2">
                                            <button onclick="openEditModal(@i)" class="p-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-all" title="Edit">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button class="p-2 bg-blue-500/20 text-blue-400 rounded-lg hover:bg-blue-500/30 transition-all" title="Copy">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                                </svg>
                                            </button>
                                            <button class="p-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-all" title="Delete">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-white/10">
                    <div class="flex items-center justify-between">
                        <div class="text-sm text-gray-400">
                            Showing <span class="font-semibold text-white">1</span> to <span class="font-semibold text-white">15</span> of <span class="font-semibold text-white">47</span> results
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                            </button>
                            <button class="px-3 py-2 bg-gradient-to-r from-purple-500 to-teal-500 text-white rounded-lg font-semibold">1</button>
                            <button class="px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-200">2</button>
                            <button class="px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-200">3</button>
                            <span class="px-3 py-2 text-gray-400">...</span>
                            <button class="px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-200">4</button>
                            <button class="px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-200">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Actions -->
            <section aria-label="Quick Actions" class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6">
                <h2 class="text-xl font-bold mb-6">Quick Actions</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <button class="bg-gradient-to-r from-purple-500 to-teal-500 text-white px-6 py-4 rounded-xl font-semibold hover:from-purple-600 hover:to-teal-600 transition-all transform hover:scale-105 text-center">
                        <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        Create New Discount
                    </button>
                    
                    <button class="bg-white/10 border border-white/20 text-white px-6 py-4 rounded-xl hover:bg-white/20 transition-all duration-200 text-center">
                        <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Bulk Import
                    </button>
                    
                    <button class="bg-white/10 border border-white/20 text-white px-6 py-4 rounded-xl hover:bg-white/20 transition-all duration-200 text-center">
                        <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Export Codes
                    </button>
                    
                    <button class="bg-white/10 border border-white/20 text-white px-6 py-4 rounded-xl hover:bg-white/20 transition-all duration-200 text-center">
                        <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                        View Analytics
                    </button>
                </div>
            </section>
    </div>

    <!-- Create Discount Modal -->
    <div id="createDiscountModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-dark-navy/95 backdrop-blur-xl border border-white/10 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-white">Create Discount</h2>
                    <button type="button" onclick="closeCreateDiscountModal()" class="p-2 hover:bg-white/10 rounded-lg transition-all">
                        <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <form asp-action="CreateDiscount" method="post" class="space-y-6">
                    @Html.AntiForgeryToken()
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label asp-for="Code" class="block text-sm font-medium text-gray-300 mb-2"></label>
                            <input asp-for="Code" type="text" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="e.g., EARLY20" maxlength="20">
                            <span asp-validation-for="Code" class="text-red-400 text-xs mt-1"></span>
                            <p class="text-gray-400 text-xs mt-1">Use uppercase letters and numbers only</p>
                        </div>
                        <div>
                            <label asp-for="Type" class="block text-sm font-medium text-gray-300 mb-2"></label>
                            <select asp-for="Type" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                                <option value="@((int)online_event_booking_system.Models.DiscountType.Percentage)">Percentage</option>
                                <option value="@((int)online_event_booking_system.Models.DiscountType.FixedAmount)">Fixed Amount</option>
                            </select>
                            <span asp-validation-for="Type" class="text-red-400 text-xs mt-1"></span>
                        </div>
                        <div>
                            <label asp-for="Value" class="block text-sm font-medium text-gray-300 mb-2"></label>
                            <div class="relative">
                                <input asp-for="Value" type="number" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="0" min="0" step="0.01">
                                <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400" id="modalValueSuffix">%</span>
                            </div>
                            <span asp-validation-for="Value" class="text-red-400 text-xs mt-1"></span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Apply To</label>
                            <div class="space-y-3">
                                <label class="flex items-center space-x-3">
                                    <input asp-for="ApplyToAllEvents" type="checkbox" class="w-4 h-4 text-purple-600 bg-white/10 border-white/20 rounded focus:ring-purple-500 focus:ring-2" id="modalApplyToAllEvents">
                                    <span class="text-gray-300">Apply to all events</span>
                                </label>
                                <div id="modalEventSelection" class="hidden">
                                    <select asp-for="EventId" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                                        <option value="">Select an event</option>
                                        @foreach (var eventOption in Model.AvailableEvents)
                                        {
                                            <option value="@eventOption.Id">@eventOption.Name - @eventOption.EventDate.ToString("MMM dd, yyyy")</option>
                                        }
                                    </select>
                                    <span asp-validation-for="EventId" class="text-red-400 text-xs mt-1"></span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label asp-for="UsageLimit" class="block text-sm font-medium text-gray-300 mb-2"></label>
                            <input asp-for="UsageLimit" type="number" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="100" min="1">
                            <span asp-validation-for="UsageLimit" class="text-red-400 text-xs mt-1"></span>
                            <p class="text-gray-400 text-xs mt-1">Leave empty for unlimited usage</p>
                        </div>
                        <div>
                            <label asp-for="ExpiryDate" class="block text-sm font-medium text-gray-300 mb-2"></label>
                            <input asp-for="ExpiryDate" type="date" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                            <span asp-validation-for="ExpiryDate" class="text-red-400 text-xs mt-1"></span>
                        </div>
                    </div>
                    <div>
                        <label asp-for="Description" class="block text-sm font-medium text-gray-300 mb-2"></label>
                        <textarea asp-for="Description" rows="3" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="Describe this discount code..."></textarea>
                        <span asp-validation-for="Description" class="text-red-400 text-xs mt-1"></span>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" onclick="closeCreateDiscountModal()" class="px-6 py-3 bg-white/10 border border-white/20 text-white rounded-xl hover:bg-white/20 transition-all duration-200">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-3 bg-gradient-to-r from-purple-500 to-teal-500 text-white rounded-xl font-semibold hover:from-purple-600 hover:to-teal-600 transition-all">
                            Create Discount
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Open Create Discount Modal
        function openCreateDiscountModal() {
            const modal = document.getElementById('createDiscountModal');
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }
        // Close Create Discount Modal
        function closeCreateDiscountModal() {
            const modal = document.getElementById('createDiscountModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }
        // Modal Discount type change handler
        document.addEventListener('DOMContentLoaded', function () {
            const typeSelect = document.querySelector('#createDiscountModal select[name="Type"]');
            const valueSuffix = document.getElementById('modalValueSuffix');
            if (typeSelect && valueSuffix) {
                typeSelect.addEventListener('change', function () {
                    valueSuffix.textContent = this.value === '2' ? '$' : '%';
                });
            }
            // Apply to all events checkbox handler
            const applyToAllCheckbox = document.getElementById('modalApplyToAllEvents');
            const eventSelection = document.getElementById('modalEventSelection');
            if (applyToAllCheckbox && eventSelection) {
                applyToAllCheckbox.addEventListener('change', function () {
                    if (this.checked) {
                        eventSelection.classList.add('hidden');
                    } else {
                        eventSelection.classList.remove('hidden');
                    }
                });
            }
        });
        // Close modal on escape
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('createDiscountModal');
                if (modal && !modal.classList.contains('hidden')) {
                    closeCreateDiscountModal();
                }
            }
        });
        // Close modal when clicking outside
        document.addEventListener('click', function (event) {
            const modal = document.getElementById('createDiscountModal');
            if (modal && event.target === modal) {
                closeCreateDiscountModal();
            }
        });
    </script>


    <!-- Edit Discount Modal -->
    <div id="editDiscountModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-dark-navy/95 backdrop-blur-xl border border-white/10 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-white">Edit Discount</h2>
                    <button onclick="closeEditModal()" class="p-2 hover:bg-white/10 rounded-lg transition-all">
                        <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <form class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Discount Code</label>
                            <input type="text" id="editCode" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="e.g., EARLY20" maxlength="20">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Discount Type</label>
                            <select id="editType" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                                <option>Percentage</option>
                                <option>Fixed Amount</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Discount Value</label>
                            <div class="relative">
                                <input type="number" id="editValue" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="0" min="0" step="0.01">
                                <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400" id="editValueSuffix">%</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Apply To</label>
                            <select id="editEvent" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                                <option>All Events</option>
                                <option>Summer Music Festival</option>
                                <option>Tech Conference 2024</option>
                                <option>Art Exhibition</option>
                                <option>Food & Wine Tasting</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Usage Limit</label>
                            <input type="number" id="editLimit" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="100" min="1">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Expiry Date</label>
                            <input type="date" id="editExpiry" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Description</label>
                        <textarea rows="3" id="editDescription" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500" placeholder="Describe this discount code..."></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" onclick="closeEditModal()" class="px-6 py-3 bg-white/10 border border-white/20 text-white rounded-xl hover:bg-white/20 transition-all duration-200">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-3 bg-gradient-to-r from-purple-500 to-teal-500 text-white rounded-xl font-semibold hover:from-purple-600 hover:to-teal-600 transition-all">
                            Update Discount
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Close on escape
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('editDiscountModal');
                if (!modal.classList.contains('hidden')) {
                    closeEditModal();
                }
            }
        });

        // Create Discount Form Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const toggleBtn = document.getElementById('toggleCreateForm');
            const toggleBtn2 = document.getElementById('toggleCreateForm2');
            const toggleText = document.getElementById('toggleText');
            const toggleText2 = document.getElementById('toggleText2');
            const createForm = document.getElementById('createDiscountForm');
            
            // Toggle form visibility
            function toggleForm() {
                if (createForm) {
                    createForm.classList.toggle('hidden');
                    const isHidden = createForm.classList.contains('hidden');
                    if (toggleText) toggleText.textContent = isHidden ? 'Create Discount' : 'Hide Form';
                    if (toggleText2) toggleText2.textContent = isHidden ? 'Show Form' : 'Hide Form';
                }
            }
            
            if (toggleBtn) {
                toggleBtn.addEventListener('click', toggleForm);
            }
            if (toggleBtn2) {
                toggleBtn2.addEventListener('click', toggleForm);
            }

            // Discount type change handler
            const typeSelect = document.querySelector('select[name="Type"]');
            const valueSuffix = document.getElementById('valueSuffix');
            const editTypeSelect = document.getElementById('editType');
            const editValueSuffix = document.getElementById('editValueSuffix');
            
            if (typeSelect && valueSuffix) {
                typeSelect.addEventListener('change', function() {
                    valueSuffix.textContent = this.value === '2' ? '$' : '%'; // 2 = FixedAmount, 1 = Percentage
                });
            }
            
            if (editTypeSelect && editValueSuffix) {
                editTypeSelect.addEventListener('change', function() {
                    editValueSuffix.textContent = this.value === 'Fixed Amount' ? '$' : '%';
                });
            }

            // Apply to all events checkbox handler
            const applyToAllCheckbox = document.querySelector('input[name="ApplyToAllEvents"]');
            const eventSelection = document.getElementById('eventSelection');
            
            if (applyToAllCheckbox && eventSelection) {
                applyToAllCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        eventSelection.classList.add('hidden');
                    } else {
                        eventSelection.classList.remove('hidden');
                    }
                });
            }
        });

        // Edit Modal Functions
        function openEditModal(index) {
            const modal = document.getElementById('editDiscountModal');
            if (modal) {
                const sampleData = {
                    code: 'EARLY20',
                    type: 'Percentage',
                    value: '20',
                    event: 'Summer Music Festival',
                    limit: '100',
                    expiry: '2024-12-31',
                    description: 'Early bird discount for summer festival'
                };
                
                // Populate form fields
                document.getElementById('editCode').value = sampleData.code;
                document.getElementById('editType').value = sampleData.type;
                document.getElementById('editValue').value = sampleData.value;
                document.getElementById('editEvent').value = sampleData.event;
                document.getElementById('editLimit').value = sampleData.limit;
                document.getElementById('editExpiry').value = sampleData.expiry;
                document.getElementById('editDescription').value = sampleData.description;
                
                // Update suffix based on type
                const editValueSuffix = document.getElementById('editValueSuffix');
                if (editValueSuffix) {
                    editValueSuffix.textContent = sampleData.type === 'Fixed Amount' ? '$' : '%';
                }
                
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeEditModal() {
            const modal = document.getElementById('editDiscountModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('editDiscountModal');
            if (modal && event.target === modal) {
                closeEditModal();
            }
        });
    </script>

    <!-- Validation Scripts -->
    @section Scripts {
        @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    }
</div>
